# 工具调用统一说明需求（上下文 / 通用结构 / 通用样式）

## 设计目标
- 炸裂炫酷但克制：浅渐变、轻阴影、微动画；与 Chat / ToolCallBox 整体风格一致，避免喧宾夺主。
- 折叠/展开顺畅，无抖动；默认首展可见，用户可收起并记忆状态。
- 统一观感：标题、状态徽标、圆角、阴影、字体层级、骨架动画保持一致。

## 适用范围
- 所有工具调用面板（搜索、文件读写/编辑、目录、TODO 等）在 ToolCallBox 内的展示。
- 生成式 UI 未命中时的回退展示也需遵循通用规范。

## 布局模式库（按工具类型选用，炫酷风格）
- 搜索（internet_search）：暗色渐变卡片网格（1–2 列自适应），卡片 hover 微上浮 + 霓虹描边，标题/域名/时间/摘要四行结构，可选相关度/耗时徽标。
- 文件读取（read_file）：信息条 + 霓虹框文本预览。顶部胶囊显示路径/大小/mtime/MIME，预览框有渐变描边与轻阴影，截断 6–8 行可展开；二进制显示下载提示。
- 文件写/编辑（write_file / edit_file）：信息条 + 统计胶囊 + Diff/预览双槽。模式/字节/行数/校验值用彩色胶囊；Diff 与预览放双卡片，边框高亮、内容滚动。
- 目录（ls）：紧凑玻璃态列表，文件夹/文件图标带主色辉光，右侧 size/mtime；列表支持滚动。
- TODO（write_todos/todo）：分组卡（进行中/待办/已完成）并列或纵向，组标题带色条；任务行含状态彩色胶囊，hover 提升。
- 回退展示：Arguments + Result 采用玻璃卡，保留折叠；标题/状态与其他组件一致。

## 通用结构（骨架统一，内容按模式替换）
- 头部区域：图标 + 工具名（14px 粗）+ 状态徽标；顶部 3px 状态色条（pending 主色、error 红、interrupted 橙、completed 绿）；可附路径/查询/统计。
- 主体区域：按模式填充（网格卡 / 信息条 + 预览 / 信息条 + Diff / 列表 / 分组列表），左右 padding p-3，行距紧凑。
- 辅助区域：错误提示（可折叠）、空态/等待提示、原始返回截断；放在主体下方或首屏空态区。
- 折叠控件：面板右上角 chevron；ToolCallBox 头部也可折叠；记忆上次展开状态。

## 状态与交互
- 状态：`pending`（骨架 + 顶部色条）、`streaming`/部分返回、`completed`、`error`、`interrupted`。
- 骨架：shimmer 渐变；pending 时与已返回内容混排；无内容时展示“等待返回…”
- 截断与滚动：文本预览 6–8 行，Diff 240–320px 上限，超出滚动；提供“展开更多/收起”。
- 错误：轻量红条，支持折叠；不遮挡已返回内容。
- 动画：进场淡入，hover 仅高亮边框/阴影，禁用 translate 造成抖动。

## 通用样式风格
- 视觉基调：暗色/玻璃态背景，浅渐变（from-background to muted），轻阴影；边框半透明，hover 增强描边与阴影，不位移。
- 尺寸/间距：整体 padding p-2~p-3；标题 14px 粗，正文 12px，辅助 11px；列表行 12px。
- 状态条：顶部 3px 细色条，随状态变色；骨架 shimmer 渐变。
- 颜色/主题：沿用主题 token（背景、边框、primary、destructive），支持暗色；可用主色/辅色做霓虹描边。
- 图标：lucide 14–16px，主色或次要色；胶囊标签使用浅底深字。

## 数据解析约定
- `result` 优先 JSON 解析，失败则按纯文本展示并截断。
- 路径字段优先级：`result.path` > `args.path` > `args.filepath` > `args.file_path` > `args.target` > `args.dst`，缺失显示“(未返回路径)”。
- 搜索结果数组字段：`results|data|items`；目录：`items|entries`；写入/编辑：`diff|preview|checksum|bytes|lines`；TODO：`items` 内含 `id/content/status/updatedAt`。

## 可访问性与性能
- 键盘可达、ARIA 标签覆盖标题按钮、折叠按钮、链接、状态文本。
- 性能：单面板渲染 < 16ms；大文本截断防卡顿；滚动区域避免撑高布局。

## 一致性要求
- 与聊天气泡、ToolCallBox 的边框/阴影/圆角/字体层级保持统一。
- 悬浮/点击效果用同一套主题与阴影深度，避免额外霓虹色。


