---
description: 优化用户提示词，澄清模糊信息，必要时检索仓库上下文，并输出结构化的标准请求。
---

## 用户输入

```text
$ARGUMENTS
```

开始前必须审视用户输入（若不为空）。

## 目标

- 将自由表达的提问转换为包含清晰意图、关键信息、约束与缺失项的标准化用户提示词。
- 当输入指向代码仓库实体时，检索当前仓库并给出相关上下文；若无命中需明确说明。
- 你的输出内容将会直接作为新会话的用户输入信息

## 护栏

- 不虚构事实、不扩大范围，保持用户意图与限制。
- 缺失/含糊信息需显式列出。
- 输出需简洁且格式稳定，便于下游解析；遵循用户语言偏好。
- 不执行实际任务，仅做用户输出表达优化。
- 必要时，需要补充相关上下文。
- 严禁对用户信息生搬硬套，必须充分理解用户输出的意图。
- 当用户提及“学习 XXX”这一类泛化表达的时候，必须具化为具体的表达，如“学习 xxx 的工作流程”、“学习 xxx 的交互过程”

## 仓库信号与检索

- 触发信号：类/函数/模块名，端点名，配置键，文件/目录片段，或“这个函数/接口/在项目里”等指代。
- 如有信号：
  - 抽取关键词（CamelCase、snake_case、路径片段、端点串）。
  - 在仓库根使用 `codebase_search`（语义）与 `rg`（精确）；明显时优先 `src/`、`api/`、`docs/` 等目录。
  - 命中项记录文件路径与一句话上下文（函数/标题/用途），片段保持简短。
  - 多个命中列出最相关的前 3 个；无命中则声明“未找到相关仓库线索”。

## 流程

1. 解析意图、主体/客体、期望产出（格式/粒度）、约束（风格/时效）、语言与格式偏好。
2. 诊断缺失或含糊点（who/what/which version/where/how）。
3. 如被触发，执行仓库检索并汇总线索。
4. 按模板重写提示词，使其可执行且不新增需求。
5. 校验：不虚构、长度克制、模板要素齐全。

## 输出模板

Task: <一句话目标>  
Known: <已知事实与确认的仓库线索，条目化>  
Expected Output: <期望产出格式/粒度/深度>  
Constraints: <风格/时效/禁止项>  
Repo Clues: <路径 + 简要上下文列表；若无写“未找到相关仓库线索”>  
Missing: <缺失或含糊信息列表；若无写“无”>

