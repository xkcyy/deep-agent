## 迭代列表（按价值与依赖排序）

### 迭代 1：工作区与 VFS 基座
- 涵盖阶段：进入工作区 → 挂载与扫描
- 范围：会话创建/切换，目录/文件挂载与授权，引导式扫描与进度展示；不含高级检索/规划。
- 进入条件：具备 Web 端基础壳；可显示会话与文件选择。
- 退出条件（DoD）：可挂载/卸载目录；扫描进度可见；挂载/扫描操作具备最小审计记录。
- 关键场景：用户创建会话，选择目录挂载，查看扫描进度并完成。
- 依赖：本地文件访问授权。
- 风险与缓解：权限失败/中断 → 显式错误与可重试；大目录 → 分批扫描提示。
- 里程碑/指标：挂载成功率 ≥99%；中等规模目录扫描可启动索引的时间 ≤2 分钟。

### 迭代 2：索引与检索体验
- 涵盖阶段：索引与检索
- 范围：自动索引与更新；关键词/语义搜索；结果展示来源与片段；按类型/时间过滤；不含智能体规划。
- 进入条件：已完成挂载/扫描，可读取文件元数据。
- 退出条件（DoD）：可发起检索并返回排序结果；结果含来源路径；过滤可用；检索操作有审计。
- 关键场景：用户检索某主题，查看 Top 结果并过滤到目标片段。
- 依赖：迭代 1（挂载/扫描）。
- 风险与缓解：大规模索引耗时 → 异步/分批、状态提示；相关性不足 → 允许用户手动选源。
- 里程碑/指标：Top3 命中率 ≥80%（试运行）；查询 P95 ≤2 秒。

### 迭代 3：智能体规划与结果生成
- 涵盖阶段：任务下达 → 推理规划 → 结果呈现
- 范围：任务输入绑定检索上下文；智能体生成分步计划并需用户确认；基于确认计划生成结果/补丁稿草案，附来源引用；允许反馈触发二次检索。
- 进入条件：检索结果可用且可绑定到任务。
- 退出条件（DoD）：可提交任务并看到计划；用户确认后生成结果；结果含引用；反馈可触发改进。
- 关键场景：用户输入编码需求，智能体基于检索源给出计划并生成补丁稿草案。
- 依赖：迭代 2（检索）。
- 风险与缓解：幻觉/错引 → 计划需确认、结果强制引用；上下文错配 → 允许用户锁定/排除文档。
- 里程碑/指标：计划确认率 ≥90%；结果相关性满意度 ≥4.2/5。

### 迭代 4：Web 交互与会话复用
- 涵盖阶段：结果呈现 → 反馈与迭代
- 范围：多会话历史、结果导出/复制、跨会话复用检索/上下文、基本协作视图（查看记录、评论/反馈）；不含实时协同编辑。
- 进入条件：迭代 3 可产出可复用结果。
- 退出条件（DoD）：会话历史可浏览；结果可复制/下载；可基于历史上下文继续任务；反馈可被记录。
- 关键场景：用户复用历史会话，复制补丁稿草案并继续迭代。
- 依赖：迭代 3（结果与反馈）。
- 风险与缓解：历史数据膨胀 → 会话归档/清理策略；权限混用 → 会话级访问控制。
- 里程碑/指标：历史复用占比 ≥40%；反馈闭环率 ≥80%。

### 迭代 5：安全、合规与可观测
- 涵盖阶段：守护与审计（贯穿）
- 范围：权限模型强化（角色/会话级）、脱敏/过滤配置、审计日志导出、关键指标仪表；不做专有合规认证实现。
- 进入条件：核心流程可用且有基础审计。
- 退出条件（DoD）：关键操作 100% 有审计；可配置脱敏/留存策略；关键指标可视。
- 关键场景：安全负责人查看访问与检索记录，导出日志；配置脱敏策略。
- 依赖：前四迭代。
- 风险与缓解：过度限制影响可用性 → 预设策略与分级配置；日志过多 → 采样/压缩。
- 里程碑/指标：审计覆盖率 100%；误封/阻断事件 ≤1%；关键指标可用率 ≥99%。

## Specify 队列（按迭代顺序）
- 迭代 1 输入草稿：
  - 短名：/speckit.specify `vfs-workspace-foundation`
  - 描述：建立 Web 会话与 VFS 挂载/扫描基座，提供授权、进度、审计。
  - 成功标准骨架：挂载成功率、扫描启动时延、最小审计可用。
  - 澄清提示：文档类型与规模上限？（与史诗澄清共享）
- 迭代 2 输入草稿：
  - 短名：/speckit.specify `vfs-search-index`
  - 描述：完成索引与检索体验，含过滤与来源展示。
  - 成功标准骨架：检索 Top3 命中率、查询时延、过滤可用性。
  - 澄清提示：是否需特定文档格式优先优化？（共享澄清 1）
- 迭代 3 输入草稿：
  - 短名：/speckit.specify `agent-planning-output`
  - 描述：将检索结果绑定任务，智能体生成计划并产出含引用的结果/补丁稿草案。
  - 成功标准骨架：计划确认率、结果相关性满意度、引用完整性。
  - 澄清提示：智能体输出可执行边界？（与史诗澄清共享）
- 迭代 4 输入草稿：
  - 短名：/speckit.specify `session-reuse-collab`
  - 描述：提供会话历史、结果导出与复用，支持反馈留存与轻量协作视图。
  - 成功标准骨架：历史复用率、反馈闭环率、导出可用性。
  - 澄清提示：数据留存/清理策略？（与史诗澄清共享）
- 迭代 5 输入草稿：
  - 短名：/speckit.specify `guardrail-observability`
  - 描述：强化权限/脱敏、审计与核心指标可观测。
  - 成功标准骨架：审计覆盖率、误阻断率、指标可用率。
  - 澄清提示：同上，使用已提出的脱敏/留存边界澄清（不新增）。

